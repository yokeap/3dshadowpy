<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="./view/node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <script defer src="./view/node_modules/@fortawesome/fontawesome-free/js/all.js"></script>
    <link rel="stylesheet" href="./view/static/css/main.css">
    <title>RayVol V.B01</title>
</head>

<header>
    <div class="bg-primary bg-gradient" id="navbarHeader">
    </div>
    <div class="navbar navbar-dark bg-primary bg-gradient shadow-sm">
        <div class="container" style="max-width: 90%;">
            <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
                <h4 class="text-white justify-content-center">RayVol V.B01 : Configuration</h4>
                
            </div>
            
            <!-- <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
             <span class="navbar-toggler-icon"></span>
            </button> -->
            <div class="d-flex flex-row">
                <a class="nav-link" href="http://localhost:5000/">
                    <span style="font-size: 28px; color: white;">
                        <i class="fas fa-home"></i>
                    </span>
                </a>
                <a class="nav-link" href="http://localhost:5000/config">
                    <span style="font-size: 28px; color: white;">
                        <i class="fas fa-cog"></i>
                    </span>
                </a>
            </div>
        </div>
    </div>
</header>

<body>
    <div class="container-fluid">

        <div class="row">

            <div class="d-flex flex-row">
                <div class="d-flex flex-column" style="max-height: 768px; overflow-y: scroll;">
                    <img class="py-2" id="img-stream" src="{{ url_for('config_feed') }}" alt="test"
                    style="max-width: 100%; object-fit: contain;">
                    <!-- <img id="img-stream" src="./view/static/img/mock.jpg" alt="test" style="max-width: 100%;"> -->
                </div>

                <div class="d-flex flex-column px-5" style="width: 400px;">
                    <!-- exposure config -->
                    <div class="d-inline-flex pt-4">
                        <label class="form-check-label text-white" for="flexSwitchCheckDefault"
                            style="width: 150px;">Exposure</label>
                        <input type="range" class="form-range align-middle px-3" min="10" max="200" step="10" id="expVal"
                            style="width: 220px;">
                        <input type="text" id="expValText" class="inputTextBox align-middle" style="width: 50px;">
                    </div>
                    <!-- Brightness config -->
                    <div class="d-inline-flex pt-4">
                        <label class="form-check-label text-white" for="flexSwitchCheckDefault"
                            style="width: 150px;">Brightness</label>
                        <input type="range" class="form-range align-middle px-3" min="-64" max="64" id="brightnessVal"
                            style="width: 220px;">
                        <input type="text" id="brightnessValText" class="inputTextBox align-middle"
                            style="width: 50px;">
                    </div>
                    <!-- Contrast config -->
                    <div class="d-inline-flex pt-4">
                        <label class="form-check-label text-white" for="flexSwitchCheckDefault"
                            style="width: 150px;">Contrast</label>
                        <input type="range" class="form-range align-middle px-3" min="-64" max="64" id="contrastVal"
                            style="width: 220px;">
                        <input type="text" id="contrastValText" class="inputTextBox align-middle" style="width: 50px;">
                    </div>
                    <!-- Hue config -->
                    <div class="d-inline-flex pt-4">
                        <label class="form-check-label text-white" for="flexSwitchCheckDefault"
                            style="width: 150px;">Hue</label>
                        <input type="range" class="form-range align-middle px-3" min="-40" max="40" id="hueVal"
                            style="width: 220px;">
                        <input type="text" id="hueValText" class="inputTextBox align-middle" style="width: 50px;">
                    </div>
                    <!--Sturation config -->
                    <div class="d-inline-flex pt-4">
                        <label class="form-check-label text-white" for="flexSwitchCheckDefault"
                            style="width: 150px;">Saturation</label>
                        <input type="range" class="form-range align-middle px-3" min="0" max="128" id="saturationVal"
                            style="width: 220px;">
                        <input type="text" id="saturationValText" class="inputTextBox align-middle"
                            style="width: 50px;">
                    </div>
                    <!--Sharpness config -->
                    <div class="d-inline-flex py-4">
                        <label class="form-check-label text-white" for="flexSwitchCheckDefault"
                            style="width: 150px;">Sharpness</label>
                        <input type="range" class="form-range align-middle px-3" min="0" max="6" id="sharpnessVal"
                            style="width: 220px;">
                        <input type="text" id="sharpnessValText" class="inputTextBox align-middle"
                            style="width: 50px;">
                    </div>

                    <div class="d-flex justify-content-around border-top pt-3">
                        <button type="button" class="btn btn-primary" onclick="saveConfig()" style="width: 30%;">Save</button>
                        <button type="button" class="btn btn-primary" onclick="loadDefault()" style="width: 30%;">Default</button>
                    </div>

                    <div class="d-flex justify-content-around border-top pt-3">
                        <button type="button" class="btn btn-primary" onclick="saveCapture()" style="width: 30%;">Capture</button>
                    </div>
                    
                </div>
            </div>
        </div>
    </div>


    <script src="./node_modules/bootstrap/dist/js/bootstrap.bundle.js"></script>
    <script>
        function postjsonServ(channel, value) {
            var req = new XMLHttpRequest();
            req.open('POST', channel, true);
            req.setRequestHeader('content-type', 'application/json');
            req.onload = function (e) {
                if (req.readyState === 4 && req.status === 200) {
                    var JSON_received = JSON.parse(req.responseText);
                    //handle received JSON here
                    console.log(JSON_received);
                    if(JSON_received != "success"){
                        console.log("set camera parameters");
                        setAllParams(JSON_received);
                    }
                } else {
                    console.log(req.responseText);
                }
            };
            // req.send(id + "=" + value);
            req.send(JSON.stringify(value));
        }
    </script>
    <!-- <script src="./view/static/js/script.js"></script> -->
    <script src="./view/static/js/camconfig.js"></script>
</body>

</html>